---
title: "Lab 1"
output:
  html_notebook:
    toc: yes
    toc_float: yes
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
---

#Setup
```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(here)
theme_set(theme_bw())
```

#Lendo dados
```{r}
all_series = read_csv(here("data/series_from_imdb.csv.zip"), 
                      col_types = "ccdcdcdddddddddddd") 

glimpse(all_series)
```


Público: Pessoas que gostam das séries especificadas e sites interessados em ranking de séries ?
 * 1 e 2 não serão todas as séries, pegar alguma lista na internet. (não exaustivo)

# 1 - Quais as séries mais bem avaliadas de drama na netflix  ? 
	Espero que seja Grey’s Anatomy.
# 2 - Quais as séries com pior avaliação de ficção-científica na netflix ?
	Acho que vai ser Mortal Kombat.
# 3 - Quais séries duraram mais que uma década ?
	Greys’s Anatomy, Friends, That 70’s show.
# 4 - Qual a melhor e pior temporada de Grey's Anatomy ?
	A que Cristina sai, acho que é na 10º. 
# 5 - Qual episódio de Strangers Things tem mais notas 0 e 10 ?
	Algum da segunda vai ter mais notas 0 e o episódio do final da primeira vai ser o com mais 10.
# 6 - Orange is the new black melhorou ou piorou com o tempo ?
	Piorou.

```{r}
# 1 - Quais as séries mais bem avaliadas de drama na netflix  ? 
# Series: 13 Reasons Why, Bates Motel, Better Call Saul, Billions,  Bloodline, Breaking Bad, Grey’s Anatomy, House of Cards, How to Get Away with Murder, Mad Men
#Fonte: https://www.minhaserie.com.br/novidades/43043-17-melhores-series-de-drama-para-assistir-na-netflix

drama_series <- c("13 Reasons Why", "Better Call Saul", "Billions", "A Anatomia de Grey", "House of Cards",  "Ozark", "Ray Donovan", "Suits", "The Crown", "The Good Wife")

sumario = all_series %>%
    filter(series_name %in% drama_series) %>%
    group_by(series_name) %>%
    summarise(median_series = median(UserRating))

glimpse(sumario)

all_series %>%
    filter(series_name %in% drama_series) %>%
    group_by(series_name) %>%
    ggplot(aes(x = series_name, y = UserRating, color = series_name)) + 
    theme(axis.text.x = element_text(angle = -60)) +
    geom_jitter(alpha = .5) +
    geom_point(data = sumario, 
            mapping = aes(x = series_name, y = median_series), 
            color = "black", 
            size = 1.5)

#TODO: pintar o minino de outra cor 
#TODO: colocar as series na mesma sequencia

```


```{r}
# 2 - Quais as séries com pior avaliação de ficção-científica na netflix ?

#Series: Black Mirror, Dark, The Expanse, Altered Carbon, Os 100, 3%, Travelers, Mars


fiction_series <- c("Black Mirror", "Dark", "The Expanse", "Altered Carbon", "Os 100", "3%", "Travelers", "Mars")

sumario = all_series %>%
    filter(series_name %in% fiction_series) %>%
    group_by(series_name) %>%
    summarise(median_series = mean(UserRating))

glimpse(sumario)


all_series %>%
    filter(series_name %in% fiction_series) %>%
    group_by(series_name) %>%
    ggplot(aes(x = series_name, y = UserRating, color = series_name)) + 
    geom_jitter(alpha = .5) +
    theme(axis.text.x = element_text(angle = -60)) +
    geom_point(data = sumario, 
            mapping = aes(x = series_name, y = median_series), 
            color = "black", 
            size = 1.5)

```

```{r}
# 3 - Quais as durações médias das séries: Grey's Anatomy,  Black Mirror, Strangers Thing, Sex and The City, Avatar: A Lenda de Korra, Orange Is the New Black, House of Cards e The Good Wife ?

my_series <- c("A Anatomia de Grey",  "Black Mirror", "Stranger Things", "Sex and the City", "Avatar: A Lenda de Korra", "Orange Is the New Black", "House of Cards", "The Good Wife")

all_series %>%
    filter(series_name %in% my_series) %>%
    group_by(series_name) %>% 
    ggplot(aes(x = season_ep, y = series_name, color = series_name)) +
    geom_line(size = 10 )

# O eixo x não parece estar certo a quatindade de episodios é bem maior
    
```

```{r}
# 4 - Quais as melhores e piores temporadas de Grey's Anatomy ?

sumario = all_series %>%
    filter(series_name == "A Anatomia de Grey") %>%
    group_by(season) %>%
    summarise(median_series = median(UserRating), media = mean(UserRating))


all_series %>% 
    filter(series_name == "A Anatomia de Grey") %>% 
    group_by(season) %>% 
    ggplot(aes(x = season, y = UserRating, color = season)) + 
    geom_point() + 
    geom_point(data = sumario, 
            mapping = aes(x = season, y = median_series), 
            color = "black", 
            size = 1.5) + 
    geom_point(data = sumario, 
            mapping = aes(x = season, y = media), 
            color = "darkred", 
            size = 1.5)
    
# A ordem ta bagunçada
  
``` 
```{r}
# 5 - Qual episódio de Strangers Things tem mais notas 0 e 10 ?

all_series %>% 
    filter(series_name == "Stranger Things") %>% 
    group_by(season) %>% 
    ggplot() + 
    geom_point(aes(x = series_ep, y = r1), color = "red") +
    geom_point(aes(x = series_ep, y = r10), color = 'green') +
    scale_x_continuous(breaks = 1:18)

# verde  = r10, vermelho = r1, como colocar isso no grafico

```


```{r}
# 6 - Orange is the new black melhorou ou piorou com o tempo ?

sumario = all_series %>%
    filter(series_name == "Orange Is the New Black") %>% 
    group_by(season) %>% 
    summarise(median_series = mean(UserRating)) %>% 
    glimpse()


all_series %>%
    filter(series_name == "Orange Is the New Black") %>% 
    group_by(season) %>% 
    ggplot(aes(x = series_ep, y = UserRating, color =  season)) +
    geom_line() 


sumario %>% 
    ggplot(aes(x = season, y = median_series, color = season)) +
    geom_point(size = 7)
    

```

